(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[79],{2898:function(e,t,r){Promise.resolve().then(r.bind(r,1053))},6463:function(e,t,r){"use strict";var n=r(1169);r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},1053:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var n=r(7437),s=r(2265),i=r(2157),o=r(3527),a=r(6463);function c(){let e=(0,a.useRouter)(),[t,r]=(0,s.useState)(!1),[c,l]=(0,s.useState)(null),[d,u]=(0,s.useState)({companyName:"",industrySector:"",city:"",email:"",password:""}),m=e=>{u({...d,[e.target.name]:e.target.value})},f=async t=>{t.preventDefault(),r(!0),l(null);try{let t=(0,i.e)(),{data:r,error:n}=await t.auth.signUp({email:d.email,password:d.password,options:{data:{role:"merchant"}}});if(n)throw n;if(!r.user)throw Error("Erreur cr\xe9ation utilisateur");await o.C.createMerchantProfile(r.user,{company_name:d.companyName,industry_sector:d.industrySector,address_city:d.city}),alert("Compte Entreprise cr\xe9\xe9 !"),e.push("/test-auth")}catch(e){l(e.message)}finally{r(!1)}};return(0,n.jsxs)("div",{className:"min-h-screen bg-zinc-900 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,n.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,n.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white",children:"Espace Commer\xe7ant"}),(0,n.jsx)("p",{className:"mt-2 text-center text-sm text-zinc-400",children:"Rejoignez le r\xe9seau RabaisLocal"})]}),(0,n.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,n.jsx)("div",{className:"bg-zinc-800 py-8 px-4 shadow sm:rounded-lg sm:px-10 border border-zinc-700",children:(0,n.jsxs)("form",{className:"space-y-6",onSubmit:f,children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-zinc-300",children:"Nom de l'entreprise"}),(0,n.jsx)("input",{name:"companyName",required:!0,type:"text",onChange:m,className:"mt-1 block w-full px-3 py-2 bg-zinc-700 border border-zinc-600 rounded-md text-white placeholder-zinc-400 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-zinc-300",children:"Secteur d'activit\xe9"}),(0,n.jsxs)("select",{name:"industrySector",onChange:m,className:"mt-1 block w-full px-3 py-2 bg-zinc-700 border border-zinc-600 rounded-md text-white focus:ring-green-500 focus:border-green-500 sm:text-sm",children:[(0,n.jsx)("option",{value:"",children:"S\xe9lectionner..."}),(0,n.jsx)("option",{value:"restauration",children:"Restauration"}),(0,n.jsx)("option",{value:"commerce",children:"Commerce de d\xe9tail"}),(0,n.jsx)("option",{value:"service",children:"Services"}),(0,n.jsx)("option",{value:"sante",children:"Sant\xe9 / Beaut\xe9"}),(0,n.jsx)("option",{value:"autre",children:"Autre"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-zinc-300",children:"Ville"}),(0,n.jsx)("input",{name:"city",required:!0,type:"text",onChange:m,className:"mt-1 block w-full px-3 py-2 bg-zinc-700 border border-zinc-600 rounded-md text-white placeholder-zinc-400 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-zinc-300",children:"Email professionnel"}),(0,n.jsx)("input",{name:"email",required:!0,type:"email",onChange:m,className:"mt-1 block w-full px-3 py-2 bg-zinc-700 border border-zinc-600 rounded-md text-white placeholder-zinc-400 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-zinc-300",children:"Mot de passe"}),(0,n.jsx)("input",{name:"password",required:!0,type:"password",onChange:m,className:"mt-1 block w-full px-3 py-2 bg-zinc-700 border border-zinc-600 rounded-md text-white placeholder-zinc-400 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm"})]}),c&&(0,n.jsx)("div",{className:"text-red-400 text-sm",children:c}),(0,n.jsx)("div",{children:(0,n.jsx)("button",{type:"submit",disabled:t,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-zinc-900 bg-green-500 hover:bg-green-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50",children:t?"Cr\xe9ation...":"Cr\xe9er mon compte Pro"})})]})})})]})}},2157:function(e,t,r){"use strict";r.d(t,{e:function(){return s}});var n=r(6038);let s=()=>(0,n.createBrowserClient)("https://sohfhzrtjbhwduaybeor.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNvaGZoenJ0amJod2R1YXliZW9yIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0NTkyNDksImV4cCI6MjA0NzAzNTI0OX0.AjgPDrIofjYkjZRHCCfnKJ_gvvf0fm7-EHHqjW0_n1w")},3527:function(e,t,r){"use strict";r.d(t,{C:function(){return i}});var n=r(2157);async function s(e,t){var r;let{data:n}=await e.from("profiles").select("id").eq("id",t.id).single();if(n)return!0;let{error:s}=await e.from("profiles").insert({id:t.id,email:t.email,role:(null===(r=t.user_metadata)||void 0===r?void 0:r.role)||"consumer"});if(s){if("23505"===s.code)return!0;throw console.error("Erreur cr\xe9ation profil manuel:",s),s}return!0}let i={async createMerchantProfile(e,t){let r=(0,n.e)();await s(r,e);let{error:i}=await r.from("merchants").insert({id:e.id,company_name:t.company_name,address_city:t.address_city,phone:t.phone,industry_sector:t.industry_sector});if(i)throw i;return!0},async createConsumerProfile(e,t){let r=(0,n.e)();await s(r,e);let{error:i}=await r.from("consumers").insert({id:e.id,first_name:t.first_name,last_name:t.last_name});if(i)throw i;return!0}}}},function(e){e.O(0,[38,971,23,744],function(){return e(e.s=2898)}),_N_E=e.O()}]);