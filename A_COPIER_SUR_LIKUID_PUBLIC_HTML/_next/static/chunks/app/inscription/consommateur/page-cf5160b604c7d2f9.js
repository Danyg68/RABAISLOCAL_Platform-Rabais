(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[443],{4636:function(e,r,s){Promise.resolve().then(s.bind(s,9436))},6463:function(e,r,s){"use strict";var t=s(1169);s.o(t,"useRouter")&&s.d(r,{useRouter:function(){return t.useRouter}})},9436:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return i}});var t=s(7437),a=s(2265),n=s(2157),o=s(3527),l=s(6463);function i(){let e=(0,l.useRouter)(),[r,s]=(0,a.useState)(!1),[i,c]=(0,a.useState)(null),[u,m]=(0,a.useState)({firstName:"",lastName:"",email:"",password:""}),d=e=>{m({...u,[e.target.name]:e.target.value})},f=async r=>{r.preventDefault(),s(!0),c(null);try{let r=(0,n.e)(),{data:s,error:t}=await r.auth.signUp({email:u.email,password:u.password,options:{data:{role:"consumer"}}});if(t)throw t;if(!s.user)throw Error("Erreur cr\xe9ation utilisateur");await o.C.createConsumerProfile(s.user,{first_name:u.firstName,last_name:u.lastName}),alert("Compte cr\xe9\xe9 avec succ\xe8s ! Bienvenue."),e.push("/test-auth")}catch(e){c(e.message)}finally{s(!1)}};return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,t.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,t.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Devenir Membre RabaisLocal"}),(0,t.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Commencez \xe0 \xe9conomiser d\xe8s aujourd'hui"})]}),(0,t.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,t.jsx)("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:(0,t.jsxs)("form",{className:"space-y-6",onSubmit:f,children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("div",{className:"w-1/2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Pr\xe9nom"}),(0,t.jsx)("input",{name:"firstName",required:!0,type:"text",onChange:d,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm text-black"})]}),(0,t.jsxs)("div",{className:"w-1/2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Nom"}),(0,t.jsx)("input",{name:"lastName",required:!0,type:"text",onChange:d,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm text-black"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,t.jsx)("input",{name:"email",required:!0,type:"email",onChange:d,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm text-black"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Mot de passe"}),(0,t.jsx)("input",{name:"password",required:!0,type:"password",onChange:d,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm text-black"})]}),i&&(0,t.jsx)("div",{className:"text-red-600 text-sm",children:i}),(0,t.jsx)("div",{children:(0,t.jsx)("button",{type:"submit",disabled:r,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-blue-300",children:r?"Cr\xe9ation...":"S'inscrire Gratuitement"})})]})})})]})}},2157:function(e,r,s){"use strict";s.d(r,{e:function(){return a}});var t=s(6038);let a=()=>(0,t.createBrowserClient)("https://sohfhzrtjbhwduaybeor.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNvaGZoenJ0amJod2R1YXliZW9yIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0NTkyNDksImV4cCI6MjA0NzAzNTI0OX0.AjgPDrIofjYkjZRHCCfnKJ_gvvf0fm7-EHHqjW0_n1w")},3527:function(e,r,s){"use strict";s.d(r,{C:function(){return n}});var t=s(2157);async function a(e,r){var s;let{data:t}=await e.from("profiles").select("id").eq("id",r.id).single();if(t)return!0;let{error:a}=await e.from("profiles").insert({id:r.id,email:r.email,role:(null===(s=r.user_metadata)||void 0===s?void 0:s.role)||"consumer"});if(a){if("23505"===a.code)return!0;throw console.error("Erreur cr\xe9ation profil manuel:",a),a}return!0}let n={async createMerchantProfile(e,r){let s=(0,t.e)();await a(s,e);let{error:n}=await s.from("merchants").insert({id:e.id,company_name:r.company_name,address_city:r.address_city,phone:r.phone,industry_sector:r.industry_sector});if(n)throw n;return!0},async createConsumerProfile(e,r){let s=(0,t.e)();await a(s,e);let{error:n}=await s.from("consumers").insert({id:e.id,first_name:r.first_name,last_name:r.last_name});if(n)throw n;return!0}}}},function(e){e.O(0,[38,971,23,744],function(){return e(e.s=4636)}),_N_E=e.O()}]);