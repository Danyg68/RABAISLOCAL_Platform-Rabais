(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[212],{8201:function(e,t,n){Promise.resolve().then(n.bind(n,742))},742:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var s=n(7437),r=n(2265),a=n(2157);let o={async getCurrentUserProfile(){let e=(0,a.e)(),{data:{user:t},error:n}=await e.auth.getUser();if(n||!t)return null;let{data:s,error:r}=await e.from("profiles").select("*").eq("id",t.id).single();return r?(console.error("Error fetching profile:",r),null):s},async hasRole(e){let t=await this.getCurrentUserProfile();return(null==t?void 0:t.role)===e}};function i(){let[e,t]=(0,r.useState)("loading"),[n,i]=(0,r.useState)(null),[l,c]=(0,r.useState)(""),[u,d]=(0,r.useState)(""),[h,m]=(0,r.useState)(""),f=(0,a.e)();async function x(){try{let{count:e,error:n}=await f.from("profiles").select("*",{count:"exact",head:!0});n&&"PGRST116"!==n.code?(console.error("Connection error:",n),t("error")):t("connected");let s=await o.getCurrentUserProfile();i(s)}catch(e){console.error(e),t("error")}}async function p(){m("Inscription en cours...");let{data:e,error:t}=await f.auth.signUp({email:l,password:u,options:{data:{role:"consumer"}}});t?m("Erreur: "+t.message):m("Inscription r\xe9ussie ! V\xe9rifiez vos emails (si confirm activ\xe9) ou le profil ci-dessous."),x()}async function b(){m("Connexion en cours...");let{data:e,error:t}=await f.auth.signInWithPassword({email:l,password:u});t?m("Erreur: "+t.message):(m("Connect\xe9 !"),x())}async function g(){await f.auth.signOut(),i(null),m("D\xe9connect\xe9.")}return(0,r.useEffect)(()=>{x()},[]),(0,s.jsxs)("div",{className:"p-8 max-w-2xl mx-auto font-sans",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Test Module 0: Identity & Access"}),(0,s.jsxs)("div",{className:"p-4 rounded-md mb-6 ".concat("connected"===e?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:["Statut Connexion Supabase : ",(0,s.jsx)("strong",{children:e.toUpperCase()})]}),(0,s.jsxs)("div",{className:"border p-6 rounded-md mb-6 bg-white shadow-sm text-black",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Test Authentification"}),n?(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"mb-4",children:["Connect\xe9 en tant que : ",(0,s.jsx)("strong",{children:n.email})]}),(0,s.jsx)("button",{onClick:g,className:"bg-gray-600 text-white px-4 py-2 rounded",children:"Se D\xe9connecter"})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("input",{type:"email",placeholder:"Email test",className:"border p-2 w-full rounded text-black",value:l,onChange:e=>c(e.target.value)}),(0,s.jsx)("input",{type:"password",placeholder:"Mot de passe",className:"border p-2 w-full rounded text-black",value:u,onChange:e=>d(e.target.value)}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:b,className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Se Connecter"}),(0,s.jsx)("button",{onClick:p,className:"bg-green-600 text-white px-4 py-2 rounded",children:"S'inscrire (Nouveau)"})]})]}),h&&(0,s.jsx)("p",{className:"mt-4 text-sm font-medium text-blue-800",children:h})]}),(0,s.jsxs)("div",{className:"border p-6 rounded-md bg-gray-50 text-black",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Donn\xe9es Profil (DB)"}),(0,s.jsx)("pre",{className:"bg-black text-white p-4 rounded text-xs overflow-auto",children:n?JSON.stringify(n,null,2):"Aucun profil charg\xe9."})]})]})}},2157:function(e,t,n){"use strict";n.d(t,{e:function(){return r}});var s=n(6038);let r=()=>(0,s.createBrowserClient)("https://sohfhzrtjbhwduaybeor.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNvaGZoenJ0amJod2R1YXliZW9yIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0NTkyNDksImV4cCI6MjA0NzAzNTI0OX0.AjgPDrIofjYkjZRHCCfnKJ_gvvf0fm7-EHHqjW0_n1w")}},function(e){e.O(0,[38,971,23,744],function(){return e(e.s=8201)}),_N_E=e.O()}]);